<mxfile host="app.diagrams.net" modified="2021-10-08T06:54:14.895Z" agent="5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.71 Safari/537.36 Edg/94.0.992.38" etag="rKxYVQsK2rLjiUSHmPIA" version="15.4.3" type="github" pages="3">
  <diagram id="mQKl8woR5209Q0s-4r6g" name="Page-1">
    <mxGraphModel dx="782" dy="468" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="MibyOEhtghfiLwJuTsJ_-1" value="&lt;h1&gt;PasteBin Design&lt;/h1&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Requirement:&lt;/p&gt;&lt;p&gt;1. store given text and return a URL for it&lt;/p&gt;&lt;p&gt;2. return the stored text/image when when the URL is accessed&lt;/p&gt;&lt;p&gt;3. link post expire ? No, keep all post for 5 years&lt;/p&gt;&lt;p&gt;4. password protected? No&lt;/p&gt;&lt;p&gt;&lt;span&gt;5. What is the max size of each post ? 10KB&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;6. Need custom URL ? Yes&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;7. What is the max size of the custom URL : 20 char&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Non-functional requirement:&lt;/p&gt;&lt;p&gt;1. Highly available to upload the data ? Yes&lt;/p&gt;&lt;p&gt;2. Highly available to read data ? Yes&lt;/p&gt;&lt;p&gt;3. Low-latency for upload ? preferable&lt;/p&gt;4. Low-latency for get ? Yes&lt;p&gt;5&lt;span&gt;. link id should not be guessable ? Yes&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;6. what is read-write ratio : 5:1&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;7. can we assume 1 million post per day? make it , 2 million&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="19" y="44" width="712" height="612" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="E-shS5h3zmg0l0LU08MJ" name="Page-2">
    <mxGraphModel dx="1632" dy="1568" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="qhK_gaoybNNiiJE-7L0O-0" />
        <mxCell id="qhK_gaoybNNiiJE-7L0O-1" parent="qhK_gaoybNNiiJE-7L0O-0" />
        <mxCell id="S6NC_K00Odwmeq3ZOr2M-0" value="&lt;h1&gt;Estimation&lt;/h1&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;br&gt;&lt;/td&gt;&lt;td&gt;&lt;br&gt;&lt;/td&gt;&lt;td&gt;&lt;br&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;1. number posts per day :&amp;nbsp; &amp;nbsp;2 Million&lt;br&gt;2. number posts per sec :&amp;nbsp; &amp;nbsp;2,000,000 / 24*3600 = ~ 24 upload per sec&lt;br&gt;&lt;br&gt;&amp;nbsp;&lt;br&gt;3. number of reads per day: 2 * 5&amp;nbsp; = 10 million&lt;br&gt;4. number of reads per sec : ~ 24 * 5 =&amp;nbsp; &amp;nbsp;120 reads per sec&lt;br&gt;&lt;br&gt;5. storage required per day : 2 million *&amp;nbsp; &amp;nbsp;10 KB&amp;nbsp; = 10GB per day&lt;br&gt;6. Storage required for 5 years:&amp;nbsp; &amp;nbsp;10 GB * 365 * 5 = 17 TB&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;br&gt;&lt;br&gt;&lt;/td&gt;&lt;td&gt;&lt;br&gt;&lt;/td&gt;&lt;td&gt;&lt;br&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;br&gt;Design:&lt;br&gt;&lt;br&gt;1. Read heavy app&lt;br&gt;2. amount of data to query is 17TB , so go for distributed DB. &lt;br&gt;3. Distributed key-Value DB like Riak is good&lt;br&gt;4. document size is small, so don&#39;t need message broker&amp;nbsp;&lt;/td&gt;&lt;td&gt;&lt;br&gt;&lt;/td&gt;&lt;td&gt;&lt;br&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;br&gt;&lt;/div&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" vertex="1" parent="qhK_gaoybNNiiJE-7L0O-1">
          <mxGeometry x="-762" y="-453" width="683" height="422" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="Ulqmq83ILlk1FTs2km8G" name="Page-3">
    <mxGraphModel dx="1632" dy="468" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="LdlfrUcyAFk2mC3OrIKB-0" />
        <mxCell id="LdlfrUcyAFk2mC3OrIKB-1" parent="LdlfrUcyAFk2mC3OrIKB-0" />
        <mxCell id="LdlfrUcyAFk2mC3OrIKB-2" value="TokenService" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="LdlfrUcyAFk2mC3OrIKB-1">
          <mxGeometry x="-210" y="140" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LdlfrUcyAFk2mC3OrIKB-3" value="TokenService" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="LdlfrUcyAFk2mC3OrIKB-1">
          <mxGeometry x="-200" y="150" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LdlfrUcyAFk2mC3OrIKB-4" value="TokenService" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="LdlfrUcyAFk2mC3OrIKB-1">
          <mxGeometry x="-190" y="160" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LdlfrUcyAFk2mC3OrIKB-5" value="PasteBinService" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="LdlfrUcyAFk2mC3OrIKB-1">
          <mxGeometry x="-210" y="260" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LdlfrUcyAFk2mC3OrIKB-6" value="PasteBinService" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="LdlfrUcyAFk2mC3OrIKB-1">
          <mxGeometry x="-200" y="270" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LdlfrUcyAFk2mC3OrIKB-7" value="PasteBinService" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="LdlfrUcyAFk2mC3OrIKB-1">
          <mxGeometry x="-190" y="280" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="hVjTKxq4bxRowZCd245O-0" value="DocumentDB" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" vertex="1" parent="LdlfrUcyAFk2mC3OrIKB-1">
          <mxGeometry x="110" y="260" width="60" height="80" as="geometry" />
        </mxCell>
        <mxCell id="4Ohwr1P_AUkBazJT-Sio-0" value="key-value" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" vertex="1" parent="LdlfrUcyAFk2mC3OrIKB-1">
          <mxGeometry x="110" y="140" width="60" height="80" as="geometry" />
        </mxCell>
        <mxCell id="4Ohwr1P_AUkBazJT-Sio-1" value="key-value" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" vertex="1" parent="LdlfrUcyAFk2mC3OrIKB-1">
          <mxGeometry x="120" y="150" width="60" height="80" as="geometry" />
        </mxCell>
        <mxCell id="4Ohwr1P_AUkBazJT-Sio-2" value="key-value" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" vertex="1" parent="LdlfrUcyAFk2mC3OrIKB-1">
          <mxGeometry x="130" y="160" width="60" height="80" as="geometry" />
        </mxCell>
        <mxCell id="4Ohwr1P_AUkBazJT-Sio-3" value="" style="endArrow=classic;html=1;rounded=0;edgeStyle=orthogonalEdgeStyle;exitX=1;exitY=0.75;exitDx=0;exitDy=0;entryX=0;entryY=1;entryDx=0;entryDy=-15;entryPerimeter=0;" edge="1" parent="LdlfrUcyAFk2mC3OrIKB-1" source="LdlfrUcyAFk2mC3OrIKB-4" target="4Ohwr1P_AUkBazJT-Sio-0">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-100" y="290" as="sourcePoint" />
            <mxPoint x="-50" y="240" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4Ohwr1P_AUkBazJT-Sio-6" value="tokenID, {available}" style="shape=card;whiteSpace=wrap;html=1;" vertex="1" parent="LdlfrUcyAFk2mC3OrIKB-1">
          <mxGeometry x="220" y="140" width="80" height="100" as="geometry" />
        </mxCell>
        <mxCell id="4Ohwr1P_AUkBazJT-Sio-7" value="tokenID, document" style="shape=card;whiteSpace=wrap;html=1;" vertex="1" parent="LdlfrUcyAFk2mC3OrIKB-1">
          <mxGeometry x="220" y="260" width="80" height="100" as="geometry" />
        </mxCell>
        <mxCell id="4Ohwr1P_AUkBazJT-Sio-8" value="" style="endArrow=classic;html=1;rounded=0;edgeStyle=orthogonalEdgeStyle;" edge="1" parent="LdlfrUcyAFk2mC3OrIKB-1" target="hVjTKxq4bxRowZCd245O-0">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-70" y="300" as="sourcePoint" />
            <mxPoint x="-50" y="210" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4Ohwr1P_AUkBazJT-Sio-9" value="APIService" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="LdlfrUcyAFk2mC3OrIKB-1">
          <mxGeometry x="-420" y="200" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4Ohwr1P_AUkBazJT-Sio-10" value="APIService" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="LdlfrUcyAFk2mC3OrIKB-1">
          <mxGeometry x="-410" y="210" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4Ohwr1P_AUkBazJT-Sio-11" value="APIService" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="LdlfrUcyAFk2mC3OrIKB-1">
          <mxGeometry x="-400" y="220" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4Ohwr1P_AUkBazJT-Sio-13" value="" style="endArrow=classic;html=1;rounded=0;edgeStyle=orthogonalEdgeStyle;exitX=1;exitY=1;exitDx=0;exitDy=0;entryX=-0.028;entryY=0.889;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="LdlfrUcyAFk2mC3OrIKB-1" source="4Ohwr1P_AUkBazJT-Sio-11" target="LdlfrUcyAFk2mC3OrIKB-5">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-100" y="260" as="sourcePoint" />
            <mxPoint x="-50" y="210" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4Ohwr1P_AUkBazJT-Sio-14" value="" style="endArrow=classic;html=1;rounded=0;edgeStyle=orthogonalEdgeStyle;exitX=1.067;exitY=0.467;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="LdlfrUcyAFk2mC3OrIKB-1" source="4Ohwr1P_AUkBazJT-Sio-11" target="LdlfrUcyAFk2mC3OrIKB-3">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-100" y="260" as="sourcePoint" />
            <mxPoint x="-50" y="210" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4Ohwr1P_AUkBazJT-Sio-16" value="Load Balancer" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="LdlfrUcyAFk2mC3OrIKB-1">
          <mxGeometry x="-580" y="180" width="80" height="140" as="geometry" />
        </mxCell>
        <mxCell id="4Ohwr1P_AUkBazJT-Sio-18" value="" style="endArrow=classic;html=1;rounded=0;edgeStyle=orthogonalEdgeStyle;entryX=0;entryY=0.75;entryDx=0;entryDy=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="LdlfrUcyAFk2mC3OrIKB-1" source="4Ohwr1P_AUkBazJT-Sio-16" target="4Ohwr1P_AUkBazJT-Sio-9">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-480" y="320" as="sourcePoint" />
            <mxPoint x="-690" y="400" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4Ohwr1P_AUkBazJT-Sio-19" value="Actor" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;outlineConnect=0;" vertex="1" parent="LdlfrUcyAFk2mC3OrIKB-1">
          <mxGeometry x="-710" y="220" width="30" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4Ohwr1P_AUkBazJT-Sio-21" value="" style="endArrow=classic;html=1;rounded=0;edgeStyle=orthogonalEdgeStyle;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="LdlfrUcyAFk2mC3OrIKB-1" source="4Ohwr1P_AUkBazJT-Sio-19" target="4Ohwr1P_AUkBazJT-Sio-16">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-550" y="250" as="sourcePoint" />
            <mxPoint x="-500" y="200" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4Ohwr1P_AUkBazJT-Sio-22" value="CleanupService" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="LdlfrUcyAFk2mC3OrIKB-1">
          <mxGeometry x="-210" y="40" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4Ohwr1P_AUkBazJT-Sio-25" value="CleanupService" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="LdlfrUcyAFk2mC3OrIKB-1">
          <mxGeometry x="-200" y="50" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4Ohwr1P_AUkBazJT-Sio-26" value="" style="endArrow=classic;html=1;rounded=0;edgeStyle=orthogonalEdgeStyle;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="LdlfrUcyAFk2mC3OrIKB-1" source="4Ohwr1P_AUkBazJT-Sio-25">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-60" y="280" as="sourcePoint" />
            <mxPoint x="140" y="130" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4Ohwr1P_AUkBazJT-Sio-27" value="" style="endArrow=classic;html=1;rounded=0;edgeStyle=orthogonalEdgeStyle;exitX=1;exitY=0.75;exitDx=0;exitDy=0;entryX=0;entryY=0;entryDx=0;entryDy=27.5;entryPerimeter=0;" edge="1" parent="LdlfrUcyAFk2mC3OrIKB-1" source="4Ohwr1P_AUkBazJT-Sio-25" target="hVjTKxq4bxRowZCd245O-0">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-60" y="280" as="sourcePoint" />
            <mxPoint x="-10" y="230" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4Ohwr1P_AUkBazJT-Sio-28" value="S3" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" vertex="1" parent="LdlfrUcyAFk2mC3OrIKB-1">
          <mxGeometry x="110" y="370" width="60" height="80" as="geometry" />
        </mxCell>
        <mxCell id="4Ohwr1P_AUkBazJT-Sio-30" value="FileName: tokenID&lt;br&gt;&lt;br&gt;&amp;nbsp;content : document" style="shape=card;whiteSpace=wrap;html=1;" vertex="1" parent="LdlfrUcyAFk2mC3OrIKB-1">
          <mxGeometry x="220" y="370" width="80" height="100" as="geometry" />
        </mxCell>
        <mxCell id="4Ohwr1P_AUkBazJT-Sio-32" value="&lt;b&gt;OR&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="LdlfrUcyAFk2mC3OrIKB-1">
          <mxGeometry x="110" y="340" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="4Ohwr1P_AUkBazJT-Sio-33" value="&lt;h1&gt;&lt;span style=&quot;font-weight: 400&quot;&gt;&lt;font style=&quot;font-size: 11px&quot;&gt;Amazon S3 is cheaper than setting up document DB. it provide eventual consistency but is ok as we don&#39;t modify file content&lt;/font&gt;&lt;/span&gt;&lt;/h1&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;align=left;" vertex="1" parent="LdlfrUcyAFk2mC3OrIKB-1">
          <mxGeometry x="-140" y="350" width="250" height="120" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
